Keyboard controls
=================


Add some keyboard controls for the Turtle ui.

```
2025-11-20		Start ðŸ–®ðŸŽ›
```


Same caveats as I had for year-clock, but am interested in adding a few keyboard controls here.
(Same issues also with inputs and focus.)

For example:
	d		- do
	c		- clear
	o		- origin
	m		- marker
	+/-		- zoom
	del		- undo last


Note that 'c' has three initial candidates - clear, center turtle, cartesian - so need to figure those out.


There was also an idea I had ages ago to preprogram some moves into the arrow keys and use them to move the turtle around.
Given how complex turtle/point arithmetic is starting to look, might want to hold off a tad on this one.
But not necessarily a bad idea.


Starting ideas
--------------

There are some keys I should probably be pretty hesitant about mapping outright such as del, home and backspace.
Pretty sure backspace as 'navigate back' is deprecated these days, but some browsers might still use it.

The couple of keyboard controls I added into year-clock were done very quickly, and I have had some ideas about how I mgiht do it better now:
* Filter out keypress events on known input types such as textareas, date inputs etc
* Have a keyboard mode toggle switch in the UI
* Only register keyboard listeners on the SVG element itself, not the whole document

The last will probably be the simplest.
Some sort of way of indicating what has focus might be nice though.


### Keyboard API

I should review this, it's marked as experimental but looks to have fairly solid browser support?:

https://developer.mozilla.org/en-US/docs/Web/API/Keyboard_API

Not sure if its new or just some parts are updated.


### Registering keyboard events

On that topic, I've been thinking about how to do it, and in the 'old' way of doing things i'd need two layers of registration i think.
A primary for the generic keydown, then a secondary to farm out the individual keys to their respective handlers.



Breaking up the App
-------------------

This has been on my mind for a little while.
The app classes are getting a bit bloated in single files/classes so I'm wondering about ways to break them apart into related concerns.
The first thoughts I had were breaking out things by type such as listeners or handlers.
That would probably be okay short term, but grouping by topic might work out a bit better.

So for instance
* application & storage - startup/shutdown, saving state
* html user interface / forms
* svg page - backgrounds/grid; the turtle
* drawing elements

That sort of looks okay, but I'm wondering where the keyboard controls should go in that scheme.
The ones I have in mind for now are mostly turtle commands, but also some page/UI controls.
Some commands might also depend on what has focus, which will affect the decision of where to register the event.

If it were to be broken up into widgets or components then each might to do their own registration.



Aside: checkJs & JSDoc
----------------------

This is something I've been curious about for a little while, but only very recently tried.
I remember reading a while back that Svelte were removing or making optional some of their TypeScript tooling, and using JSDoc instead in some places - I don't remember the details.

So it seems that there are ways of opting in to some TS-style typechecking without a complete changeover.
The details of all this I'm still figuring out, and some might be VSCode setup specific.

For now I've added a minimal `jsconfig.json` file and started fixing the code:
```json
{
	"compilerOptions": {
		"checkJs": true,
		"target": "es2024", // es6, es2024
	}
}
```

With that in place it's a bit more pernickity about things like page elements having the correct interfaces - eg using regular `getElementById` sometimes doesn't return the right *type*.
Had to fix some HTML form elements and SVGGraphicsElement references; also it wants me junk old/bad code which is good.
I tried adding some type annotations, but will come back to that.

The updates for Turtle were *fairly* easy, once I'd figured out what it wants and how to fix it, so I'll keep it around here for a while and see how things go.
I can always turn it off for a stint if needed.

